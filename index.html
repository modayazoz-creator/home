<!DOCTYPE html>
<html lang="ar" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مؤسسة بلاي فيلم | الملف التعريفي والكتالوج</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .hero-bg {
            background-color: #0d2447;
            background-image: linear-gradient(rgba(13, 36, 71, 0.85), rgba(13, 36, 71, 0.85)), url('https://placehold.co/1920x1080/0d2447/ffffff?text=Digital+Infrastructure');
            background-size: cover;
            background-position: center;
        }
        .nav-link {
            transition: color 0.3s;
        }
        .nav-link:hover {
            color: #fbbf24; /* amber-400 */
        }
        .tab-btn.active {
            border-color: #1e40af; /* blue-800 */
            background-color: #1e40af;
            color: white;
        }
        .brand-logo {
            filter: grayscale(100%);
            opacity: 0.6;
            transition: all 0.3s ease-in-out;
        }
        .brand-logo:hover {
            filter: grayscale(0%);
            opacity: 1;
            transform: scale(1.1);
        }
        /* Spinner for loading animation */
        .loader {
            border: 5px solid #f3f3f3; /* Light grey */
            border-top: 5px solid #1e40af; /* Blue */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Custom styles for AI consultant response */
        #ai-response ul {
            list-style-type: disc;
            margin-right: 20px;
            margin-top: 10px;
        }
        #ai-response h5 {
            font-weight: 700; /* bold */
            color: #1e3a8a; /* blue-900 */
            margin-top: 1rem;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header & Navigation -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-black text-blue-900">
                بلاي فيلم
            </div>
            <div class="hidden md:flex space-x-6 space-x-reverse">
                <a href="#home" class="nav-link font-semibold text-gray-700">الرئيسية</a>
                <a href="#profile" class="nav-link font-semibold text-gray-700">ملفنا التعريفي</a>
                <a href="#catalog" class="nav-link font-semibold text-gray-700">كتالوج الحلول</a>
                <a href="#ai-consultant" class="nav-link font-semibold text-gray-700">المستشار الذكي</a>
                <a href="#process" class="nav-link font-semibold text-gray-700">منهجيتنا</a>
                <a href="#contact" class="nav-link font-semibold text-gray-700">تواصل معنا</a>
            </div>
             <div class="md:hidden">
                <button id="menu-btn" class="text-gray-700 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-white py-2">
            <a href="#home" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">الرئيسية</a>
            <a href="#profile" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">ملفنا التعريفي</a>
            <a href="#catalog" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">كتالوج الحلول</a>
            <a href="#ai-consultant" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">المستشار الذكي</a>
            <a href="#process" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">منهجيتنا</a>
            <a href="#contact" class="mobile-nav-link block px-6 py-2 text-sm text-gray-700 hover:bg-gray-100">تواصل معنا</a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="home" class="hero-bg text-white py-24 md:py-32">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight">مهندس الحلول التقنية المتكاملة</h1>
                <p class="mt-4 text-lg md:text-2xl font-semibold text-amber-300">شريك استراتيجي في تحقيق رؤية المملكة 2030</p>
                <p class="mt-6 max-w-3xl mx-auto text-gray-200">نصمم وننفذ أنظمة التيار الخفيف والأمن المتقدم لبناء بنية تحتية ذكية وآمنة تدعم مستقبل المملكة.</p>
                <a href="#catalog" class="mt-8 inline-block bg-amber-400 hover:bg-amber-500 text-blue-900 font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105">
                    تصفح كتالوج الحلول
                </a>
            </div>
        </section>

        <!-- Company Profile Section -->
        <section id="profile" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-900">ملفنا التعريفي: الريادة في الحلول الذكية</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-600">منذ تأسيسنا، عملنا كمهندس للحلول التقنية، ملتزمين بتقديم أنظمة عالية الموثوقية تساهم في التحول الرقمي للمملكة.</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                    <div>
                        <h3 class="text-2xl font-bold text-blue-900 mb-4">رؤيتنا ورسالتنا</h3>
                        <p class="text-gray-700 mb-4"><strong>الرؤية:</strong> أن نكون الخيار الأول في المملكة لتصميم وتنفيذ حلول التيار الخفيف والأنظمة الأمنية الذكية.</p>
                        <p class="text-gray-700"><strong>الرسالة:</strong> توفير أنظمة متكاملة ومخصصة تتجاوز توقعات عملائنا، من خلال الجمع بين أفضل التقنيات العالمية والخبرة المحلية العميقة، للمساهمة بفعالية في بناء مستقبل آمن ومستدام.</p>
                         <div class="mt-8 text-center bg-blue-900 text-white p-8 rounded-xl shadow-xl">
                            <h3 class="text-2xl font-bold text-amber-300">التوافق مع رؤية 2030</h3>
                            <p class="mt-3 max-w-4xl mx-auto">نساهم بشكل مباشر في دعم محاور "مجتمع حيوي" و "اقتصاد مزدهر" عبر بناء مدن ومرافق أكثر أمانًا وذكاءً واستدامة.</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 text-center">
                        <div class="bg-slate-50 p-6 rounded-xl shadow-lg border-t-4 border-blue-800">
                            <p class="text-4xl font-black text-blue-900">103 مليار</p>
                            <p class="text-lg font-bold text-gray-700 mt-1">ريال</p>
                            <p class="text-sm text-gray-500">حجم سوق تقنية المعلومات المتوقع (2025)</p>
                        </div>
                        <div class="bg-slate-50 p-6 rounded-xl shadow-lg border-t-4 border-amber-400">
                            <p class="text-4xl font-black text-blue-900">3.67 مليار</p>
                            <p class="text-lg font-bold text-gray-700 mt-1">دولار</p>
                            <p class="text-sm text-gray-500">حجم سوق الأمن السيبراني المتوقع (2029)</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Catalog Section -->
        <section id="catalog" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-900">كتالوج الحلول والخدمات</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-600">نقدم محفظة شاملة من الأنظمة المترابطة التي تغطي كافة جوانب البنية التحتية للتيار الخفيف والأمن المتقدم.</p>
                </div>
                
                <!-- Tabs Navigation -->
                <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
                    <button class="tab-btn active text-lg font-bold py-2 px-6 border-2 border-transparent rounded-lg transition" data-tab="security">المراقبة والأمن</button>
                    <button class="tab-btn text-lg font-bold py-2 px-6 border-2 border-transparent rounded-lg transition" data-tab="access">التحكم بالدخول</button>
                    <button class="tab-btn text-lg font-bold py-2 px-6 border-2 border-transparent rounded-lg transition" data-tab="comms">الاتصالات والصوتيات</button>
                    <button class="tab-btn text-lg font-bold py-2 px-6 border-2 border-transparent rounded-lg transition" data-tab="smart">المباني الذكية</button>
                    <button class="tab-btn text-lg font-bold py-2 px-6 border-2 border-transparent rounded-lg transition" data-tab="energy">الطاقة المتجددة</button>
                </div>

                <!-- Tabs Content -->
                <div class="bg-white p-8 rounded-xl shadow-lg">
                    <div id="security" class="tab-content grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="text-center"><span class="text-3xl">🎥</span><h4 class="font-bold mt-2">كاميرات CCTV</h4><p class="text-sm text-gray-500">أنظمة مراقبة داخلية وخارجية عالية الدقة.</p></div>
                        <div class="text-center"><span class="text-3xl">🧠</span><h4 class="font-bold mt-2">تحليلات الفيديو الذكية</h4><p class="text-sm text-gray-500">كشف الحركة، التعرف على الوجوه، تتبع الأجسام.</p></div>
                        <div class="text-center"><span class="text-3xl">🚨</span><h4 class="font-bold mt-2">أنظمة الإنذار ضد السرقة</h4><p class="text-sm text-gray-500">حساسات حركة وأبواب متصلة بمركز التحكم.</p></div>
                    </div>
                    <div id="access" class="tab-content hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                         <div class="text-center"><span class="text-3xl">👆</span><h4 class="font-bold mt-2">قارئات البصمة والوجه</h4><p class="text-sm text-gray-500">حلول بيومترية لأعلى مستويات الأمان.</p></div>
                         <div class="text-center"><span class="text-3xl">💳</span><h4 class="font-bold mt-2">أنظمة البطاقات الذكية</h4><p class="text-sm text-gray-500">بطاقات دخول قابلة للبرمجة والإدارة المركزية.</p></div>
                         <div class="text-center"><span class="text-3xl">🚧</span><h4 class="font-bold mt-2">بوابات وحواجز أمنية</h4><p class="text-sm text-gray-500">للتحكم في دخول المركبات والأفراد.</p></div>
                    </div>
                    <div id="comms" class="tab-content hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                         <div class="text-center"><span class="text-3xl">📢</span><h4 class="font-bold mt-2">أنظمة النداء العام</h4><p class="text-sm text-gray-500">للتوجيهات والإعلانات في الأماكن العامة.</p></div>
                         <div class="text-center"><span class="text-3xl">📞</span><h4 class="font-bold mt-2">أنظمة الاتصال الداخلي (Intercom)</h4><p class="text-sm text-gray-500">صوتية ومرئية للمباني والمجمعات.</p></div>
                         <div class="text-center"><span class="text-3xl">🧑‍💻</span><h4 class="font-bold mt-2">حلول غرف الاجتماعات</h4><p class="text-sm text-gray-500">أنظمة صوتية ومرئية متكاملة.</p></div>
                    </div>
                    <div id="smart" class="tab-content hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="text-center"><span class="text-3xl">💡</span><h4 class="font-bold mt-2">أنظمة التحكم بالإضاءة</h4><p class="text-sm text-gray-500">لترشيد استهلاك الطاقة وخلق بيئات مريحة.</p></div>
                        <div class="text-center"><span class="text-3xl">🌡️</span><h4 class="font-bold mt-2">التحكم بالتكييف (HVAC)</h4><p class="text-sm text-gray-500">لإدارة مركزية فعالة لأنظمة التبريد والتدفئة.</p></div>
                        <div class="text-center"><span class="text-3xl">📈</span><h4 class="font-bold mt-2">نظام إدارة المباني (BMS)</h4><p class="text-sm text-gray-500">منصة موحدة للتحكم ومراقبة جميع الأنظمة.</p></div>
                    </div>
                    <div id="energy" class="tab-content hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                         <div class="text-center"><span class="text-3xl">☀️</span><h4 class="font-bold mt-2">الألواح الشمسية</h4><p class="text-sm text-gray-500">حلول طاقة نظيفة للمنشآت التجارية والسكنية.</p></div>
                         <div class="text-center"><span class="text-3xl">🔋</span><h4 class="font-bold mt-2">أنظمة تخزين الطاقة</h4><p class="text-sm text-gray-500">بطاريات لتخزين الطاقة وضمان استمراريتها.</p></div>
                         <div class="text-center"><span class="text-3xl">🔌</span><h4 class="font-bold mt-2">حلول الطاقة الاحتياطية</h4><p class="text-sm text-gray-500">أنظمة UPS لضمان عدم انقطاع التيار.</p></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- START: AI Consultant Section -->
        <section id="ai-consultant" class="py-20 bg-slate-100">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-900">مستشارك الذكي للحلول التقنية ✨</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-600">صف لنا مشروعك أو احتياجاتك، وسيقوم مستشارنا الذكي بتحليلها وتقديم توصيات أولية مخصصة لك في ثوانٍ.</p>
                </div>
                <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg">
                    <div class="mb-6">
                        <label for="project-description" class="block mb-2 font-bold text-lg text-gray-700">صف مشروعك هنا:</label>
                        <textarea id="project-description" rows="6" class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-800 text-lg" placeholder="مثال: أحتاج إلى نظام أمني متكامل لمستودع جديد بمساحة 2000 متر مربع، مع التحكم في الدخول للموظفين ومراقبة بالفيديو للمحيط الخارجي..."></textarea>
                    </div>
                    <button id="get-recommendation-btn" class="w-full bg-amber-400 hover:bg-amber-500 text-blue-900 font-bold text-xl py-4 px-6 rounded-lg transition-transform transform hover:scale-105">
                        الحصول على توصية فورية
                    </button>
                    <div id="ai-result-container" class="mt-8 hidden">
                        <h3 class="text-2xl font-bold text-blue-900 border-b-2 border-amber-400 pb-2 mb-4">التوصيات الأولية لمشروعك:</h3>
                        <div id="loader" class="loader hidden"></div>
                        <div id="ai-response" class="text-gray-700 space-y-4 prose prose-lg"></div>
                    </div>
                </div>
            </div>
        </section>
        <!-- END: AI Consultant Section -->

        <!-- Process Section -->
        <section id="process" class="py-20 bg-white">
             <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-900">منهجيتنا: شراكة تضمن النجاح</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-600">نتبع عملية عمل منضبطة تضمن أعلى مستويات الجودة والموثوقية من الفكرة وحتى الدعم ما بعد البيع.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="bg-slate-50 p-8 rounded-xl shadow-lg text-center border-b-4 border-blue-800">
                        <div class="text-5xl mb-4">🏆</div>
                        <h3 class="font-bold text-xl mb-2">1. الجودة العالمية</h3>
                        <p class="text-gray-600">نلتزم بتوريد منتجات موثوقة من أفضل العلامات التجارية العالمية مع تطبيق اختبارات صارمة.</p>
                    </div>
                    <div class="bg-slate-50 p-8 rounded-xl shadow-lg text-center border-b-4 border-blue-800">
                        <div class="text-5xl mb-4">🎯</div>
                        <h3 class="font-bold text-xl mb-2">2. الحلول المخصصة</h3>
                        <p class="text-gray-600">نصمم حلولًا تقنية تلبي الاحتياجات الفريدة لكل عميل بعد دراسة دقيقة للمتطلبات.</p>
                    </div>
                    <div class="bg-slate-50 p-8 rounded-xl shadow-lg text-center border-b-4 border-amber-400">
                        <div class="text-5xl mb-4">🛠️</div>
                        <h3 class="font-bold text-xl mb-2">3. التركيب الاحترافي</h3>
                        <p class="text-gray-600">ينفذ أعمال التركيب والبرمجة مهندسون وفنيون معتمدون لضمان الأداء الأمثل.</p>
                    </div>
                    <div class="bg-slate-50 p-8 rounded-xl shadow-lg text-center border-b-4 border-amber-400">
                        <div class="text-5xl mb-4">⚙️</div>
                        <h3 class="font-bold text-xl mb-2">4. الصيانة والدعم</h3>
                        <p class="text-gray-600">نوفر عقود دعم شاملة وصيانة استباقية لضمان استمرارية عمل الأنظمة بكفاءة.</p>
                    </div>
                </div>
             </div>
        </section>
        
        <!-- Partners Section -->
        <section id="partners" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-900">شركاؤنا في النجاح</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-600">نحن نفخر بالتعاون مع رواد التكنولوجيا العالميين لنقدم لكم أفضل الحلول الموثوقة.</p>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8 items-center">
                    <img src="https://placehold.co/200x100/f0f0f0/a0a0a0?text=BOSCH" alt="Bosch" class="brand-logo mx-auto">
                    <img src="https://placehold.co/200x100/f0f0f0/a0a0a0?text=Hikvision" alt="Hikvision" class="brand-logo mx-auto">
                    <img src="https://placehold.co/200x100/f0f0f0/a0a0a0?text=Honeywell" alt="Honeywell" class="brand-logo mx-auto">
                    <img src="https://placehold.co/200x100/f0f0f0/a0a0a0?text=CISCO" alt="Cisco" class="brand-logo mx-auto">
                    <img src="https://placehold.co/200x100/f0f0f0/a0a0a0?text=Axis" alt="Axis Communications" class="brand-logo mx-auto">
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20 bg-blue-900 text-white">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-extrabold">تواصل معنا</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-gray-200">فريقنا مستعد لمناقشة مشروعك وتقديم الاستشارة اللازمة. تفضل بزيارتنا في أحد فروعنا أو أرسل لنا رسالة.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                    <div class="bg-white text-gray-800 p-8 rounded-lg shadow-lg">
                         <form>
                             <div class="mb-4">
                                <label for="name" class="block mb-2 font-bold">الاسم الكامل</label>
                                <input type="text" id="name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-800">
                             </div>
                             <div class="mb-4">
                                <label for="email" class="block mb-2 font-bold">البريد الإلكتروني</label>
                                <input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-800">
                             </div>
                              <div class="mb-4">
                                <label for="message" class="block mb-2 font-bold">رسالتك</label>
                                <textarea id="message" rows="5" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-800" placeholder="اكتب كلمات رئيسية مثل 'كاميرات لمصنع' ثم اضغط على المساعد..."></textarea>
                             </div>
                             <!-- START: AI Draft Button -->
                             <div class="mb-6 text-center">
                                <button type="button" id="ai-draft-btn" class="w-full md:w-auto bg-slate-200 hover:bg-slate-300 text-slate-800 font-bold py-2 px-5 rounded-lg transition-colors">
                                    ✨ ساعدني في كتابة رسالتي
                                </button>
                             </div>
                             <!-- END: AI Draft Button -->
                             <button type="submit" class="w-full bg-blue-800 hover:bg-blue-900 text-white font-bold py-3 px-6 rounded-lg transition">إرسال</button>
                         </form>
                    </div>
                    <div class="space-y-8">
                        <div>
                           <h3 class="text-2xl font-bold border-b-2 border-amber-400 pb-2 mb-4">📍 المقر الرئيسي - الرياض</h3>
                           <p class="text-gray-200">طريق الملك فهد، الرياض 12345</p>
                           <p class="text-gray-200">هاتف: 920000000</p>
                           <p class="text-gray-200">بريد إلكتروني: info@playfilm.sa</p>
                        </div>
                        <div>
                           <h3 class="text-2xl font-bold border-b-2 border-amber-400 pb-2 mb-4">📍 فرع التشغيل - جدة</h3>
                           <p class="text-gray-200">شارع الأمير سلطان، جدة 67890</p>
                           <p class="text-gray-200">هاتف: 012-0000000</p>
                        </div>
                         <div>
                           <h3 class="text-2xl font-bold border-b-2 border-amber-400 pb-2 mb-4">📍 فرع التشغيل - مكة المكرمة</h3>
                           <p class="text-gray-200">العزيزية، مكة المكرمة 11223</p>
                           <p class="text-gray-200">هاتف: 012-1111111</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 مؤسسة بلاي فيلم للتجارة. جميع الحقوق محفوظة.</p>
        </div>
    </footer>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Existing JS ---
        const menuBtn = document.getElementById('menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
        mobileNavLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.add('hidden'));
                button.classList.add('active');
                document.getElementById(button.getAttribute('data-tab')).classList.remove('hidden');
            });
        });

        // --- START: Gemini API Integration for AI Consultant ---
        const getRecommendationBtn = document.getElementById('get-recommendation-btn');
        const projectDescriptionInput = document.getElementById('project-description');
        const aiResultContainer = document.getElementById('ai-result-container');
        const loader = document.getElementById('loader');
        const aiResponseDiv = document.getElementById('ai-response');

        getRecommendationBtn.addEventListener('click', async () => {
            const userQuery = projectDescriptionInput.value;
            if (!userQuery.trim()) {
                aiResponseDiv.innerHTML = `<p class="text-red-600 font-bold">الرجاء إدخال وصف لمشروعك أولاً.</p>`;
                aiResultContainer.classList.remove('hidden');
                return;
            }

            aiResultContainer.classList.remove('hidden');
            loader.classList.remove('hidden');
            aiResponseDiv.innerHTML = '';
            getRecommendationBtn.disabled = true;

            const apiKey = ""; // API key will be provided by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const systemPrompt = `أنت مستشار حلول تقنية خبير في مؤسسة بلاي فيلم للتجارة، وهي شركة متخصصة في أنظمة التيار الخفيف والأمن المتقدم. بناءً على وصف المشروع الذي يقدمه المستخدم، قم بإنشاء قائمة أولية بالأنظمة والمنتجات الموصى بها. يجب أن تكون توصياتك من الفئات التالية فقط: المراقبة والأمن، التحكم بالدخول، الاتصالات والصوتيات، المباني الذكية، الطاقة المتجددة. قدم تبريرًا موجزًا لكل توصية. يجب أن يكون الناتج على شكل قائمة منسقة وواضحة باستخدام عناوين فرعية لكل فئة، وتنسيق Markdown للنقاط. ابدأ الرد مباشرة بالقائمة دون أي مقدمات.`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    let htmlResponse = candidate.content.parts[0].text;
                    htmlResponse = htmlResponse.replace(/\*\*(.*?)\*\*/g, '<h5>$1</h5>');
                    htmlResponse = htmlResponse.replace(/(\r\n|\n|\r)/g, '<br>');
                    htmlResponse = htmlResponse.replace(/\* (.*?)(<br>|$)/g, '<ul><li>$1</li></ul>');
                    htmlResponse = htmlResponse.replace(/<\/ul><br><ul>/g, '');
                    aiResponseDiv.innerHTML = htmlResponse;
                } else {
                    throw new Error("لم يتم العثور على محتوى في استجابة الـ API.");
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                aiResponseDiv.innerHTML = `<p class="text-red-600 font-bold">عذرًا، حدث خطأ أثناء محاولة الحصول على التوصية. يرجى المحاولة مرة أخرى لاحقًا.</p>`;
            } finally {
                loader.classList.add('hidden');
                getRecommendationBtn.disabled = false;
            }
        });
        // --- END: Gemini API Integration for AI Consultant ---

        // --- START: Gemini API for Contact Form Assistant ---
        const aiDraftBtn = document.getElementById('ai-draft-btn');
        const messageTextarea = document.getElementById('message');

        aiDraftBtn.addEventListener('click', async () => {
            const userKeywords = messageTextarea.value;
            if (!userKeywords.trim()) {
                messageTextarea.placeholder = 'الرجاء إدخال كلمات رئيسية أولاً لوصف طلبك...';
                return;
            }

            const originalButtonText = aiDraftBtn.innerHTML;
            aiDraftBtn.innerHTML = 'لحظات، الذكاء الاصطناعي يكتب...';
            aiDraftBtn.disabled = true;

            const apiKey = ""; // Provided by environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const systemPrompt = `أنت مساعد ذكي متخصص في صياغة استفسارات احترافية. بناءً على الكلمات الرئيسية أو الوصف الموجز الذي يقدمه المستخدم، قم بصياغة رسالة استفسار مفصلة ومحترفة موجهة إلى مؤسسة بلاي فيلم للتجارة. يجب أن تذكر الرسالة نوع المشروع، وتطلب معلومات حول الحلول الممكنة، وتدعو إلى التواصل لمناقشة التفاصيل. اجعل النص ودودًا واحترافيًا. ابدأ الرسالة بتحية مناسبة مثل "تحية طيبة فريق بلاي فيلم،".`;

            const payload = {
                contents: [{ parts: [{ text: userKeywords }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    messageTextarea.value = candidate.content.parts[0].text;
                    messageTextarea.classList.add('bg-amber-100', 'transition-colors');
                    setTimeout(() => {
                        messageTextarea.classList.remove('bg-amber-100');
                    }, 1500);
                } else {
                    throw new Error("لم يتم العثور على محتوى في استجابة الـ API.");
                }
            } catch (error) {
                console.error("Error calling Gemini API for drafting:", error);
                messageTextarea.placeholder = 'عذرًا، حدث خطأ. يرجى المحاولة مرة أخرى.';
            } finally {
                aiDraftBtn.innerHTML = originalButtonText;
                aiDraftBtn.disabled = false;
            }
        });
        // --- END: Gemini API for Contact Form Assistant ---
    });
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أداة تحليل وتحسين النصوص</title>
    <!-- تحميل Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- خط Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Cairo:wght@200..1000&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', 'Inter', sans-serif;
            background-color: #f8fafc; /* Slate 50 */
        }
        .gemini-button {
            transition: all 0.2s;
        }
        .gemini-button:hover {
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }
        /* Custom scrollbar for better look */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-thumb {
            background-color: #94a3b8; /* Slate 400 */
            border-radius: 4px;
        }
        .qa-list div {
            border-right: 4px solid #f97316; /* Orange 500 */
        }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-6xl mx-auto bg-white shadow-xl rounded-2xl p-6 md:p-8 border border-gray-100">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-2 border-b pb-2">
            مُحسّن المستندات التجاري <span class="text-blue-600">بواسطة Gemini</span>
        </h1>
        <p class="text-gray-500 mb-6">
            استخدم نموذج Gemini API لتحليل محتوى مستندك (مؤسسة بلاي فيلم) وإنشاء ملخصات أو شعارات تسويقية إبداعية.
        </p>

        <!-- منطقة إدخال النص -->
        <label for="document-text" class="block text-lg font-medium text-gray-700 mb-2">محتوى المستند:</label>
        <textarea id="document-text" rows="15"
            class="w-full p-4 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 shadow-inner resize-y">ريادة الأمن الذكي والتقنيات المتقدمة: رؤية مؤسسة بلاي فيلم للتجارة
I. الملخص التنفيذي: الابتكار من أجل مستقبل آمن
تقف مؤسسة بلاي فيلم للتجارة ككيان سعودي رائد، مكرس لتصميم ونشر وصيانة حلول الأمن الذكي المتطورة وتقنيات التيار الخفيف المتقدمة. بفضل سجلها الحافل والراسخ في كل من القطاعين الخاص والحكومي، تلتزم المؤسسة برفع مستويات السلامة والكفاءة التشغيلية والاتصال السلس عبر بيئات متنوعة، تشمل البنى التحتية السكنية والتجارية والصناعية والعامة.
تتمحور كفاءات المؤسسة الأساسية حول مجموعة شاملة من الخدمات: بدءًا من أنظمة المراقبة المتقدمة المدعومة بالذكاء الاصطناعي وأنظمة التحكم الذكي بالدخول، وصولًا إلى شبكات الاتصالات الحديثة وتقنيات المباني الذكية المتكاملة. كل حل من هذه الحلول مدعوم بالتزام لا يتزعزع بالجودة الفائقة والتصميم المبتكر والنهج المرتكز على العميل.
في طليعة التبني التكنولوجي، تستفيد المؤسسة من أحدث التطورات مثل الذكاء الاصطناعي للتحليلات التنبؤية والأنظمة الذكية المتكاملة. وهذا يضمن أن عروضها ليست حديثة فحسب، بل هي جاهزة للمستقبل، وتساهم بفعالية وتتوافق مع الأهداف التحويلية لرؤية المملكة 2030. إن التركيز الصريح للمؤسسة على "الأمن الذكي" و"التقنيات المتقدمة" يضعها في موقع يتجاوز...ظة حلولنا باستمرار. وهذا يضمن أننا مستعدون دائمًا لتلبية المتطلبات المتطورة لمشهد الأمن والتكنولوجيا.
تركز مبادراتنا المستقبلية استراتيجيًا على تعميق دمج الذكاء الاصطناعي المتقدم، وإنترنت الأشياء (IoT)، والحلول السحابية المتطورة. وهذا سيمكننا من تقديم أنظمة أمن وأتمتة أكثر ذكاءً وتنبؤًا وترابطًا. من خلال تبني تقنيات الجيل التالي هذه، نضمن أن عملاءنا يستفيدون من أحدث الحلول وأكثرها كفاءة المتاحة، مما يتوقع التحديات والفرص المستقبلية. إن هذا الموقف الاستباقي في تبني التكنولوجيا يضع مؤسسة بلاي فيلم للتجارة ليس فقط كمزود للحلول الحالية، بل كقائد سوق ذي رؤية. ويوفر هذا طمأنة حاسمة للعملاء المحتملين بأن استثماراتهم في أنظمة بلاي فيلم ستكون محصنة للمستقبل، وقادرة على التكيف مع التهديدات الناشئة والتطورات التكنولوجية. وهذا عامل تمييز حاسم لجذب شراكات طويلة الأجل وذات قيمة عالية، حيث يسعى العملاء إلى الاستقرار والقدرات المتطورة في استثماراتهم الأمنية والبنية التحتية.
الخلاصة: شراكة من أجل غدٍ أكثر ذكاءً وأمانًا
تقف مؤسسة بلاي فيلم للتجارة كشركة رائدة متميزة في مشهد الأمن الذكي والتقنيات المتقدمة في المملكة العربية السعودية. إن مجموعتنا الشاملة من الحلول المبتكرة، المقترنة بالتزام لا يتزعزع بج...
        </textarea>

        <!-- الأزرار والإجراءات -->
        <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <button id="summarize-btn"
                class="gemini-button flex items-center justify-center px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                ✨ تلخيص تنفيذي
            </button>
            <button id="slogans-btn"
                class="gemini-button flex items-center justify-center px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                ✨ اقتراح شعارات تسويقية
            </button>
            <button id="proofread-btn"
                class="gemini-button flex items-center justify-center px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                ✨ تدقيق لغوي واحترافي
            </button>
            <button id="qa-generator-btn"
                class="gemini-button flex items-center justify-center px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
                ✨ توليد أسئلة وأجوبة
            </button>
        </div>

        <!-- منطقة النتائج -->
        <div id="loading-indicator" class="hidden mt-6 text-center">
            <div class="flex items-center justify-center space-x-2 rtl:space-x-reverse">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                <span class="text-blue-600 font-medium">جاري تحليل المحتوى بواسطة Gemini...</span>
            </div>
        </div>

        <div id="results-area" class="mt-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2 mb-4">النتائج:</h2>
            
            <!-- مخرج التلخيص -->
            <div id="summary-output" class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200 hidden">
                <p class="font-semibold text-blue-800 mb-2">الملخص التنفيذي:</p>
                <div class="text-gray-800 whitespace-pre-wrap" id="summary-content"></div>
            </div>

            <!-- مخرج الشعارات -->
            <div id="slogans-output" class="mb-6 p-4 bg-green-50 rounded-lg border border-green-200 hidden">
                <p class="font-semibold text-green-800 mb-2">الشعارات التسويقية المقترحة:</p>
                <div class="space-y-4" id="slogans-list"></div>
            </div>

            <!-- مخرج التدقيق اللغوي -->
            <div id="proofread-output" class="mb-6 p-4 bg-red-50 rounded-lg border border-red-200 hidden">
                <p class="font-semibold text-red-800 mb-2">النص المُحسَّن والمُدقَّق:</p>
                <div class="text-gray-800 whitespace-pre-wrap" id="proofread-content"></div>
            </div>

            <!-- مخرج الأسئلة والأجوبة -->
            <div id="qa-output" class="mb-6 p-4 bg-orange-50 rounded-lg border border-orange-200 hidden">
                <p class="font-semibold text-orange-800 mb-2">أسئلة وأجوبة تدريبية:</p>
                <div class="space-y-4 qa-list" id="qa-list-content"></div>
            </div>

            <div id="error-message" class="hidden p-4 bg-red-100 rounded-lg border border-red-400 text-red-700">
                حدث خطأ: <span id="error-details"></span>
            </div>
        </div>
    </div>

    <script type="module">
        // تهيئة الإعدادات الأساسية
        const apiKey = ""; // سيتم توفيرها تلقائيًا في بيئة Canvas
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        // عناصر واجهة المستخدم
        const textInput = document.getElementById('document-text');
        const summarizeBtn = document.getElementById('summarize-btn');
        const slogansBtn = document.getElementById('slogans-btn');
        const proofreadBtn = document.getElementById('proofread-btn');
        const qaGeneratorBtn = document.getElementById('qa-generator-btn');

        const loadingIndicator = document.getElementById('loading-indicator');
        
        // مناطق المخرجات
        const summaryOutput = document.getElementById('summary-output');
        const summaryContent = document.getElementById('summary-content');
        const slogansOutput = document.getElementById('slogans-output');
        const slogansList = document.getElementById('slogans-list');
        const proofreadOutput = document.getElementById('proofread-output');
        const proofreadContent = document.getElementById('proofread-content');
        const qaOutput = document.getElementById('qa-output');
        const qaListContent = document.getElementById('qa-list-content');

        const errorMessageDiv = document.getElementById('error-message');
        const errorDetailsSpan = document.getElementById('error-details');

        // قائمة بجميع مخرجات النتائج لإخفائها بسهولة
        const allOutputs = [summaryOutput, slogansOutput, proofreadOutput, qaOutput];

        /**
         * دالة للتحكم في حالة التحميل والأخطاء
         * @param {boolean} isLoading - تحديد حالة التحميل
         * @param {string | null} error - رسالة الخطأ (إذا وجدت)
         */
        function setAppState(isLoading, error = null) {
            summarizeBtn.disabled = isLoading;
            slogansBtn.disabled = isLoading;
            proofreadBtn.disabled = isLoading;
            qaGeneratorBtn.disabled = isLoading;
            loadingIndicator.classList.toggle('hidden', !isLoading);
            errorMessageDiv.classList.toggle('hidden', !error);
            if (error) {
                errorDetailsSpan.textContent = error;
            }
        }

        /**
         * دالة مساعدة لإجراء استدعاء API لـ Gemini مع التراجع الأُسِّي (Exponential Backoff)
         * @param {Object} payload - حمولة طلب Gemini API
         * @param {number} maxRetries - الحد الأقصى لعدد محاولات إعادة الإرسال
         * @returns {Promise<Object>} - استجابة API
         */
        async function fetchWithBackoff(payload, maxRetries = 3) {
            let attempt = 0;
            while (attempt < maxRetries) {
                try {
                    const headers = { 'Content-Type': 'application/json' };
                    // نحتاج إلى إضافة headers لتحديد نوع المحتوى كـ JSON إذا كنا نتوقع مخططًا (Schema)
                    if (payload.generationConfig?.responseMimeType === "application/json") {
                         headers['Content-Type'] = 'application/json';
                    }

                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.status === 429 && attempt < maxRetries - 1) {
                        // حد المعدل (Rate Limit)، ننتظر ونحاول مرة أخرى
                        const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        attempt++;
                        continue;
                    }

                    if (!response.ok) {
                        const errorBody = await response.json();
                        throw new Error(`API Error: ${response.status} - ${errorBody.error?.message || 'Unknown error'}`);
                    }

                    return response.json();

                } catch (error) {
                    attempt++;
                    if (attempt >= maxRetries) {
                        throw error;
                    }
                    // في حالة أخطاء أخرى (مثل خطأ في الشبكة)، نحاول مرة أخرى مع تراجع
                    const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }

        // دالة لإخفاء جميع مخرجات النتائج
        function hideAllOutputs() {
            allOutputs.forEach(output => output.classList.add('hidden'));
        }

        /**
         * الميزة الأولى: تلخيص النص وتحويله إلى ملخص تنفيذي
         */
        summarizeBtn.onclick = async () => {
            hideAllOutputs();
            setAppState(true);
            summaryContent.textContent = ''; 

            const documentText = textInput.value;
            if (!documentText.trim()) {
                setAppState(false, 'الرجاء إدخال نص لتحليله.');
                return;
            }

            const systemPrompt = "أنت خبير في التحليل التجاري والتلخيص. مهمتك هي قراءة النص المقدم وإعداد ملخص تنفيذي موجز ومقنع لا يتجاوز 150 كلمة. ركز على المكونات الأساسية للشركة (الرؤية، الكفاءات الأساسية، والتوجهات المستقبلية) باللغة العربية. اكتب النتيجة في فقرة واحدة فقط.";
            const userQuery = `لخص النص التالي في ملخص تنفيذي موجز: \n\n${documentText}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await fetchWithBackoff(payload);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    summaryContent.textContent = text;
                    summaryOutput.classList.remove('hidden');
                } else {
                    setAppState(false, 'لم يتمكن Gemini من إنشاء الملخص.');
                    return;
                }

            } catch (error) {
                console.error("Gemini API Error for summary:", error);
                setAppState(false, `فشل في الاتصال بـ Gemini: ${error.message}`);
                return;
            }

            setAppState(false);
        };

        /**
         * الميزة الثانية: اقتراح شعارات تسويقية باستخدام إخراج JSON منظم
         */
        slogansBtn.onclick = async () => {
            hideAllOutputs();
            setAppState(true);
            slogansList.innerHTML = ''; 

            const documentText = textInput.value;
            if (!documentText.trim()) {
                setAppState(false, 'الرجاء إدخال نص لتحليله.');
                return;
            }

            const systemPrompt = "أنت مسوق إبداعي وخبير في صياغة الشعارات. بناءً على تفاصيل الشركة المقدمة (اسمها ورؤيتها ومنتجاتها - الأمن الذكي والتقنيات المتقدمة)، قم بإنشاء ثلاثة (3) شعارات تسويقية حديثة وجذابة باللغة العربية يمكن استخدامها في حملات الفيديو. يجب أن يكون الناتج بتنسيق JSON صارم يطابق المخطط المحدد.";
            const userQuery = `بناءً على هذا النص، اقترح ثلاثة شعارات تسويقية لـ "مؤسسة بلاي فيلم للتجارة": \n\n${documentText}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "slogans": {
                                "type": "ARRAY",
                                "description": "List of three marketing slogans.",
                                "items": {
                                    "type": "OBJECT",
                                    "properties": {
                                        "slogan": { "type": "STRING", "description": "The creative marketing slogan in Arabic." },
                                        "description": { "type": "STRING", "description": "A brief explanation of the slogan's meaning and application." }
                                    },
                                    "propertyOrdering": ["slogan", "description"]
                                }
                            }
                        }
                    }
                }
            };

            try {
                const result = await fetchWithBackoff(payload);
                const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (jsonText) {
                    const parsedJson = JSON.parse(jsonText);
                    const slogans = parsedJson.slogans;

                    if (slogans && Array.isArray(slogans)) {
                        slogansList.innerHTML = slogans.map((item, index) => `
                            <div class="p-4 bg-white rounded-lg shadow border border-green-300">
                                <p class="text-xl font-bold text-green-700 mb-1">الشعار ${index + 1}: ${item.slogan}</p>
                                <p class="text-gray-600">${item.description}</p>
                            </div>
                        `).join('');
                        slogansOutput.classList.remove('hidden');
                    } else {
                        setAppState(false, 'هيكل JSON غير متوقع أو الشعارات مفقودة.');
                    }
                } else {
                    setAppState(false, 'لم يتمكن Gemini من إنشاء الشعارات (لا يوجد إخراج JSON).');
                    return;
                }

            } catch (error) {
                console.error("Gemini API Error for slogans:", error);
                setAppState(false, `فشل في الاتصال بـ Gemini أو خطأ في تحليل JSON: ${error.message}`);
                return;
            }

            setAppState(false);
        };

        /**
         * الميزة الثالثة: التدقيق اللغوي والتحسين الاحترافي
         */
        proofreadBtn.onclick = async () => {
            hideAllOutputs();
            setAppState(true);
            proofreadContent.textContent = ''; 

            const documentText = textInput.value;
            if (!documentText.trim()) {
                setAppState(false, 'الرجاء إدخال نص للتدقيق.');
                return;
            }

            const systemPrompt = "أنت خبير تدقيق وتحرير لغوي عربي، ومتخصص في تحسين الوثائق التجارية. مهمتك هي: 1. تصحيح جميع الأخطاء الإملائية والنحوية والأسلوبية. 2. إعادة صياغة النص بأسلوب احترافي وقوي ومقنع يتناسب مع وثائق الشركات والمستثمرين، مع الحفاظ على المعنى الأصلي. أخرج النص النهائي المحسن فقط، بدون أي تعليقات أو مقدمات.";
            const userQuery = `قم بالتدقيق والتحسين الاحترافي للنص التالي: \n\n${documentText}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            try {
                const result = await fetchWithBackoff(payload);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    proofreadContent.textContent = text;
                    proofreadOutput.classList.remove('hidden');
                } else {
                    setAppState(false, 'لم يتمكن Gemini من تحسين النص.');
                    return;
                }

            } catch (error) {
                console.error("Gemini API Error for proofreading:", error);
                setAppState(false, `فشل في الاتصال بـ Gemini: ${error.message}`);
                return;
            }

            setAppState(false);
        };

        /**
         * الميزة الرابعة: توليد أسئلة وأجوبة للمقابلات
         */
        qaGeneratorBtn.onclick = async () => {
            hideAllOutputs();
            setAppState(true);
            qaListContent.innerHTML = ''; 

            const documentText = textInput.value;
            if (!documentText.trim()) {
                setAppState(false, 'الرجاء إدخال نص لتوليد الأسئلة والأجوبة.');
                return;
            }

            const systemPrompt = "أنت مصمم مقابلات متخصص. بناءً على النص الذي يصف شركة 'مؤسسة بلاي فيلم للتجارة' ومنتجاتها (الأمن الذكي، التيار الخفيف)، قم بإنشاء أربعة (4) أسئلة وأجوبة تدريبية أو مقابلات باللغة العربية. يجب أن تركز الأسئلة على فهم المرشحين لأعمال الشركة وقدرتهم على توصيل قيمتها المضافة. يجب أن يكون الناتج بتنسيق JSON صارم يطابق المخطط المحدد.";
            const userQuery = `قم بتوليد 4 أسئلة وأجوبة تدريبية بناءً على أعمال وخدمات الشركة المذكورة في النص التالي: \n\n${documentText}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "training_qa": {
                                "type": "ARRAY",
                                "description": "List of four Q&A pairs for training/interview purposes.",
                                "items": {
                                    "type": "OBJECT",
                                    "properties": {
                                        "question": { "type": "STRING", "description": "The interview or training question in Arabic." },
                                        "answer": { "type": "STRING", "description": "The concise and professional answer to the question in Arabic." }
                                    },
                                    "propertyOrdering": ["question", "answer"]
                                }
                            }
                        }
                    }
                }
            };

            try {
                const result = await fetchWithBackoff(payload);
                const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (jsonText) {
                    const parsedJson = JSON.parse(jsonText);
                    const qaPairs = parsedJson.training_qa;

                    if (qaPairs && Array.isArray(qaPairs)) {
                        qaListContent.innerHTML = qaPairs.map((item, index) => `
                            <div class="p-4 bg-white rounded-lg shadow-md border-r-4 border-orange-500">
                                <p class="text-lg font-bold text-gray-800 mb-1">سؤال ${index + 1}:</p>
                                <p class="text-orange-700 font-semibold mb-2">${item.question}</p>
                                <p class="text-lg font-bold text-gray-800 mb-1">إجابة:</p>
                                <p class="text-gray-600">${item.answer}</p>
                            </div>
                        `).join('');
                        qaOutput.classList.remove('hidden');
                    } else {
                        setAppState(false, 'هيكل JSON غير متوقع أو أزواج الأسئلة والأجوبة مفقودة.');
                    }
                } else {
                    setAppState(false, 'لم يتمكن Gemini من توليد الأسئلة (لا يوجد إخراج JSON).');
                    return;
                }

            } catch (error) {
                console.error("Gemini API Error for Q&A:", error);
                setAppState(false, `فشل في الاتصال بـ Gemini أو خطأ في تحليل JSON: ${error.message}`);
                return;
            }

            setAppState(false);
        };
    </script>

</body>
</html>
